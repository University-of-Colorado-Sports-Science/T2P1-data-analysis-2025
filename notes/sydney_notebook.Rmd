---
title: "sydney-notebook"
output: html_document
date: "2025-06-16"
---

```{r}
library(tidyverse)
library(readxl)
library(aod)
library(tidyverse)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
```

```{r}
#load all of the useful datasets
ACWR <- read.csv("~/T2P1-data-analysis-2025/data-sets/ACWR-Catapult FB.csv")
catapult <- read.csv("~/T2P1-data-analysis-2025/data-sets/Catapult Session - Outdoor FB.csv")
incident <- read.csv("~/T2P1-data-analysis-2025/data-sets/Incident Report FB.csv")
perfnorm <- read.csv("~/T2P1-data-analysis-2025/data-sets/Performance Normative Data FB.csv")
perfrisk <- read.csv("~/T2P1-data-analysis-2025/data-sets/Performance Risk Assessment FB.csv")
riskstatus <- read.csv("~/T2P1-data-analysis-2025/data-sets/Soft Tissue Risk Status Report FB.csv")
strengthtest <- read.csv("~/T2P1-data-analysis-2025/data-sets/Strength Testing Data FB.csv")
VALD <- read.csv("~/T2P1-data-analysis-2025/data-sets/VALD - Performance Test FB.csv")
wellness <- read.csv("~/T2P1-data-analysis-2025/data-sets/Wellness Report FB.csv")
```

## Data Cleaning 

1.ACWR- Catapult 
```{r}
ACWR <- read.csv("~/T2P1-data-analysis-2025/data-sets/ACWR-Catapult FB.csv")
```

```{r}
library(dplyr)
library(lubridate)
#refined ACWR dataset 
ACWR <- ACWR %>%
  filter(Sport=="FOOTBALL")
Acwr <- subset(ACWR,select=c("anon_id","Date","Position","Total.Player.Load","Acute.Total.Acceleration.Load.EWMA","Acceleration.Load.ACWR","Player.Load.ACWR","Total.Distance.ACWR"))

#cut back to last 24 months (last 2 years)
Acwr$Date <- mdy(Acwr$Date)

current_date <- Sys.Date()
start_date <- current_date- months(24)

filtered_Acwr <- Acwr %>%
  filter(Date >= start_date)

#Filtered_Acwr <- na.omit(Filtered_Acwr)
#optional cuts down 14k obs. to 2k obs.
```
```{r}
min(filtered_Acwr$Date,na.rm=TRUE)
max(filtered_Acwr$Date,na.rm=TRUE)
```

2. Catapult Session- Outdoor 
```{r}
catapult <- read.csv("~/T2P1-data-analysis-2025/data-sets/Catapult Session - Outdoor FB.csv")
```

```{r}
#remove periods + venues 
catapult <- catapult[,-c(16,19,20,21)]

#sort out any non football values
catapult <- catapult %>%
filter(Sport=="FOOTBALL")
catapult <- catapult[,-c(6)]  #remove sport column b/c not needed anymore

#cut back to last 6 months (can repeat to do last 3 months aswell or instead)
catapult$Date <- mdy(catapult$Date)
current_date <- Sys.Date()
start_date <- current_date- months(24)
catapult <- catapult %>%
  filter(Date >= start_date)
```
```{r}
filtered_catapult <- subset(catapult,select=c("anon_id","Date","Primary.Position","Position","Total.Distance","Maximum.Velocity","Average.Velocity","TRIMP", "Velocity.Exertion", "Total.Player.Load", "Player.Load.min","Total.Acceleration.Load","Acceleration.Density.Index","Explosive.Efforts","Max.Acceleration","Max.Deceleration","Session.Mean.TRIMP","HSD.SD","VHSD.SD","Typical.Player.Load","Typical.Player.Load","Typical.Player.Load.min","Average.IMA","Session.Classification"))

#can also add averaged bands(1-8) columns of diffrent metrics 
```
```{r}
min(filtered_catapult$Date,na.rm=TRUE)
max(filtered_catapult$Date,na.rm=TRUE)
```

##Just to look into other metrics, averaged (below)
```{r}
#combine date (3rd column) + athlete (2nd column // anon_id) to make an average/max or sum depending 
#group by (anon_id+Date), take the mean of all numerical columns 
Catapult <- catapult %>%
  group_by(anon_id, Date) %>%
  summarise(across(where(is.numeric), mean, na.rm=FALSE))
#Catapult dataset only has numerical values 

#Catapult<- na.omit(Catapult)
```

```{r}
#IMAs are counted variable so sum these
mean(catapult$High.Speed.Distance,na.rm=TRUE)
mean(catapult$Maximum.Velocity,na.rm=TRUE)
mean(catapult$Total.Player.Load,na.rm=TRUE)
mean(catapult$Player.Load.min,na.rm=TRUE)

#Maximum + average of the maximum & average velocity (given to us)
max(catapult$Maximum.Velocity,na.rm=TRUE)
mean(catapult$Average.Velocity,na.rm=TRUE)

#velocity + acceleration + deceleration + player load + IMA most important to pay attention to 
```

3. Incident Report
```{r}
incident <- read.csv("~/T2P1-data-analysis-2025/data-sets/Incident Report FB.csv")
```
```{r}
#sort out any non football values + etc
incident <- incident %>%
filter(Sport=="FOOTBALL") %>%
filter(Incident.Type=="Injury") %>%
filter(Result.of.Sport.Participation=="Yes")
#selecting the variables of interest within the incident report
filtered_incident <- subset(incident,select=c("anon_id", "Position", "Date.of.Injury...Onset.of.symptoms", "Side", "Body.Part", "Tissue.Type", "Pathology.Type", "OSICS14.Code", "OSICS10.Code", "OSICS10.Diagnosis", "Final.Diagnosis", "Result.of.Sport.Participation", "Recurrence.of.Injury", "Injury.Prognosis", "General.Mechanism", "Specific.Mechanism", "FinalDiagnosisIncidentDate", "Total.Time.Injured", "Month", "Year","Incident.Type"))

#cut back to last 6 months (can repeat to do last 3 months aswell or instead)
filtered_incident$Date <- mdy(filtered_incident$Date)
current_date1 <- Sys.Date()
start_date1 <- current_date1- months(24)
filtered_incident <- filtered_incident %>%
  filter(Date >= start_date1)
```
```{r}
min(filtered_incident$Date,na.rm=TRUE)
max(filtered_incident$Date,na.rm=TRUE)
```

4. Performance Normative Data
```{r}
perfnorm <- read.csv("~/T2P1-data-analysis-2025/data-sets/Performance Normative Data FB.csv")
```
```{r}
filtered_perfnorm <- subset(perfnorm,select=c("anon_id","Date","Position","Nordic.Average","Nordic.Imbalance..","Adduction.Abduction.Ratio","Eccentric.Peak.Power...Relative","Jump.Height","Modified.RSI"))

#cut back to last 6 months (can repeat to do last 3 months aswell or instead)
filtered_perfnorm$Date <- mdy(filtered_perfnorm$Date)
current_date <- Sys.Date()
start_date <- current_date- months(24)
filtered_perfnorm <- filtered_perfnorm %>%
  filter(Date >= start_date)

PERFnorm <- filtered_perfnorm %>%
  group_by(anon_id, Date) %>%
  summarise(across(where(is.numeric), mean, na.rm=FALSE))
#can compare to NFL + NBA aswell

min(filtered_perfnorm$Date,na.rm=TRUE)
max(filtered_perfnorm$Date,na.rm=TRUE)
```

5.Performance Risk Assessment
##DATASET ONLY FROM ONE DAY OF LAST YEAR// THEREFORE PROBABLY NOT THAT RELEVANT TO US
#other than for possible comparisons 
```{r}
perfrisk <- read.csv("~/T2P1-data-analysis-2025/data-sets/Performance Risk Assessment FB.csv")

#filter football
perfrisk <- perfrisk %>%
  filter(Sport=="FOOTBALL")
```

```{r}
#ALL variables are relevant
filtered_perfrisk <- subset(perfrisk,select=c("anon_id", "Date","Position","Hamstring.Avg..Imbalance", "L..Hamstring.Max.Force","R..Hamstring.Max.Force","L..Eccentric.Mean.Force","R..Eccentric.Mean.Force","Eccentric.Mean.Force.Asym","CMJ.Landing.Asym.","CMJ.Jump.Height","Groin.Avg..Imbalance", "Relative.Peak.Power","CMJ.Peak.Force","IMTP.Peak.Force"))
```

```{r}
min(filtered_perfrisk$Date,na.rm=TRUE)
max(filtered_perfrisk$Date,na.rm=TRUE)
```















```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
